{"version":3,"sources":["-","../../../mam.ts","../../../mol/dom/context/context.ts","../../../mol/dom/context/context.web.ts","../../../mol/dom/dom.ts","../../../mol/dom/render/children/children.ts","../../../my/lom/view/view.ts","../../../my/lom/storage/storage.ts","../../../my/lom/button/button.ts","../../../my/lom/input/input.ts","../../../mol/style/attach/attach.ts","../../../my/lom/theme/theme.ts","../../../my/counter/counter.ts","../../../my/counter/-css/counter.css.ts"],"names":[],"mappings":"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","sourcesContent":[null,"Error.stackTraceLimit = 50;\n\ndeclare let _$_: { new(): {} } & typeof globalThis\ndeclare class $ extends _$_ {}\n\nnamespace $ {\n\texport type $ = typeof $$\n\texport declare class $$ extends $ {}\n\tnamespace $$ {\n\t\texport type $$ = $\n\t}\n}\n\nmodule.exports = $\n","namespace $ {\n\t\n\texport var $mol_dom_context : typeof globalThis\n\t\n}\n","namespace $ {\n\t\n\t$.$mol_dom_context = self as any\n\t\n}\n","namespace $ {\n\t\n\texport var $mol_dom = $mol_dom_context\n\t\n}\n","namespace $ {\n\n\texport function $mol_dom_render_children (\n\t\tel : Element | DocumentFragment ,\n\t\tchildNodes : NodeList | Array< Node | string | null >\n\t) {\n\t\tconst node_set = new Set< Node | string | null >( childNodes )\n\t\t\n\t\tlet nextNode : Node | null = el.firstChild\n\t\tfor( let view of childNodes ) {\n\n\t\t\tif( view == null ) continue\n\n\t\t\tif( view instanceof $mol_dom_context.Node ) {\n\t\t\t\t\n\t\t\t\twhile( true ) {\n\t\t\t\t\tif( !nextNode ) {\n\t\t\t\t\t\tel.appendChild( view )\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tif( nextNode == view ) {\n\t\t\t\t\t\tnextNode = nextNode.nextSibling\n\t\t\t\t\t\tbreak\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( node_set.has( nextNode ) ) {\n\t\t\t\t\t\t\tel.insertBefore( view , nextNode )\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst nn = nextNode.nextSibling\n\t\t\t\t\t\t\tel.removeChild( nextNode )\n\t\t\t\t\t\t\tnextNode = nn\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tif( nextNode && nextNode.nodeName === '#text' ) {\n\t\t\t\t\tconst str = String( view )\n\t\t\t\t\tif( nextNode.nodeValue !== str ) nextNode.nodeValue = str\n\t\t\t\t\tnextNode = nextNode.nextSibling\n\t\t\t\t} else {\n\t\t\t\t\tconst textNode = $mol_dom_context.document.createTextNode( String( view ) )\n\t\t\t\t\tel.insertBefore( textNode , nextNode )\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\twhile( nextNode ) {\n\t\t\tconst currNode = nextNode\n\t\t\tnextNode = currNode.nextSibling\n\t\t\tel.removeChild( currNode )\n\t\t}\n\t}\n\n}\n","class $my_lom_view {\n\n\t// Тут и ниже, такие поля используются для кеширования.\n\t// Удалятся при добавлении реактивности, в следующей главе\n\t_dom_node = null as unknown as Element\n\t// Создание DOM-ноды и регистрация событий на ней\n\tdom_node() {\n\t\tif ( this._dom_node ) return this._dom_node\n\n\t\tconst node = document.createElement( this.dom_name() )\n\n\t\tfor ( const [name, fn] of Object.entries(this.event()) ) {\n\t\t\tnode.addEventListener(name ,fn)\n\t\t}\n\n\t\t// Атрибут с именем класса, для матчинга из css\n\t\tnode.setAttribute('view', this.constructor.name)\n\n\t\treturn this._dom_node = node\n\t}\n\n\t// Актуализация атрибутов и полей\n\tdom_node_actual() {\n\t\tconst node = this.dom_node()\n\n\t\tfor ( const [name, val] of Object.entries(this.attr()) ) {\n\t\t\tnode.setAttribute(name, String(val))\n\t\t}\n\n\t\tfor ( const [name, val] of Object.entries(this.field()) ) {\n\t\t\t;(node as any)[name] = val\n\t\t}\n\n\t\treturn node\n\t}\n\n\t// Подготовка и рендеринг дочерних компонентов\n\tdom_tree() {\n\t\tconst node = this.dom_node_actual()\n\n\t\tconst node_list = this.sub().map( node => {\n\t\t\tif ( node === null ) return null\n\t\t\treturn node instanceof $my_lom_view ? node.dom_tree() : String(node)\n\t\t} )\n\n\t\t// Воспользуемся рендером из $mol\n\t\t$.$mol_dom_render_children( node , node_list )\n\n\t\treturn node\n\t}\n\n\t// Методы ниже будут переопредялятся в компонентах-наследниках\n\t\n\t// Имя DOM-элемента\n\tdom_name() {\n\t\treturn 'div'\n\t}\n\t// Объект с атрибутами\n\tattr(): { [key: string]: string|number|boolean|null } {\n\t\treturn {}\n\t}\n\t// Объект с событиями\n\tevent(): { [key: string]: (e: Event) => any } {\n\t\treturn {}\n\t}\n\t// Объекст с полями\n\tfield(): { [key: string]: any } {\n\t\treturn {}\n\t}\n\t// Дочерние компоненты\n\tsub(): Array<$my_lom_view | Node | string | number | boolean> {\n        return []\n    }\n\n}\n","// mam/my/counter/storage/storage.ts\n\nclass $my_lom_storage {\n\n\tstatic value<Value>( key: string, next?: Value ) {\n\t\tif ( next === undefined ) return JSON.parse( localStorage.getItem( key ) ?? 'null' )\n\n\t\tif ( next === null ) localStorage.removeItem( key )\n\t\telse localStorage.setItem( key, JSON.stringify( next ) )\n\n\t\treturn next\n\t}\n\n}\n","// mam/jk1mn/counter/button/button.ts\n\nclass $my_lom_button extends $my_lom_view {\n\tdom_name() { return 'button' }\n\n\ttitle() { return '' }\n\n\tclick( e: Event ) {}\n\n\tsub() {\n\t\treturn [ this.title() ]\n\t}\n\n\tevent() {\n\t\treturn {\n\t\t\tclick: (e: Event) => this.click(e)\n\t\t}\n\t}\n}\n\nclass $my_lom_button_minor extends $my_lom_button {\n\tattr() {\n\t\treturn {\n\t\t\t'jk1mn_counter_button_minor': true,\n\t\t}\n\t}\n}\n","// mam/jk1mn/counter/input/input.ts\n\nclass $my_lom_input extends $my_lom_view {\n\tdom_name() { return 'input' }\n\n\ttype() { return 'text' }\n\n\t_value = ''\n\tvalue( next = this._value ) {\n\t\treturn this._value = next\n\t}\n\n\tevent_change( e: Event ) {\n\t\tthis.value( (e.target as HTMLInputElement).value )\n\t}\n\n\tfield() {\n\t\treturn {\n\t\t\tvalue: this.value(),\n\t\t}\n\t}\n\n\tattr() {\n\t\treturn {\n\t\t\ttype: this.type(),\n\t\t}\n\t}\n\n\tevent() {\n\t\treturn {\n\t\t\tinput: (e: Event)=> this.event_change(e),\n\t\t}\n\t}\n}\n","namespace $ {\n\n\texport function $mol_style_attach(\n\t\tid : string ,\n\t\ttext : string ,\n\t) {\n\n\t\tconst doc = $mol_dom_context.document\n\t\tif( !doc ) return null\n\t\t\n\t\tconst elid = `$mol_style_attach:${id}`\n\t\t\n\t\tlet el = doc.getElementById( elid ) as HTMLStyleElement\n\t\tif( !el ) {\n\t\t\tel = doc.createElement('style')\n\t\t\tel.id = elid\n\t\t\tdoc.head.appendChild( el )\n\t\t}\n\t\tif( el.innerHTML != text ) el.innerHTML = text\n\t\t\n\t\treturn el\n\t}\n\n}\n","setInterval( ()=> {\n\tif ( typeof document === 'undefined' ) return\n\t\n\tdocument?.documentElement.setAttribute(\n\t\t'my_lom_theme' ,\n\t\tnew Date().getSeconds() < 30 ? 'light' : 'dark' ,\n\t)\n} , 1_000 )\n","class $my_counter extends $my_lom_view {\n\n\tcount( next?: number ) {\n\t\treturn $my_lom_storage.value( 'count' , next ) ?? 0\n\t}\n\n\tcount_str( next?: string ) {\n\t\treturn this.count( next?.valueOf && Number(next) ).toString()\n\t}\n\n\tinc() {\n\t\tthis.count( this.count() + 1 )\n\t}\n\n\tdec() {\n\t\tthis.count( this.count() - 1 )\n\t}\n\n\t// Создаем инстанс Button\n\t// Переопределяем title\n\t// click биндим на this.inc\n\t_Inc = null as unknown as $my_lom_view\n\tInc() {\n\t\tif (this._Inc) return this._Inc\n\t\t\n\t\tconst obj = new $my_lom_button\n\t\tobj.title = ()=> '+'\n\t\tobj.click = ()=> this.inc()\n\n\t\treturn this._Inc = obj\n\t}\n\n\t_Dec = null as unknown as $my_lom_view\n\tDec() {\n\t\tif (this._Dec) return this._Dec\n\n\t\tconst obj = new $my_lom_button\n\t\tobj.title = ()=> '-'\n\t\tobj.click = ()=> this.dec()\n\n\t\treturn this._Dec = obj\n\t}\n\n\t_Count = null as unknown as $my_lom_view\n\tCount() {\n\t\tif (this._Count) return this._Count\n\n\t\tconst obj = new $my_lom_input\n\t\tobj.value = (next?: string)=> this.count_str( next )\n\n\t\treturn this._Count = obj\n\t}\n\n\tsub() {\n\t\treturn [\n\t\t\tthis.Dec(),\n\t\t\tthis.Count(),\n\t\t\tthis.Inc(),\n\t\t]\n\t}\n\n\tstatic mount() {\n\t\tif ( typeof document === 'undefined' ) return\n\t\t\n\t\tconst node = document.querySelector( '#root' )\n\t\tconst obj = new $my_counter()\n\n\t\tnode?.replaceWith( obj.dom_tree() )\n\n\t\t// Реактивность добавится в следующей главе, сейчас воспользуемся костылем\n\t\tsetInterval( ()=> obj.dom_tree() , 100 )\n\t}\n}\n\n// Вызываем для монтирования приложения в DOM-дерево\n$my_counter.mount()\n","namespace $ { $mol_style_attach( \"my/counter/counter.css\",\n \"/* mam/my/counter/counter.css */\\n[my_lom_theme=\\\"light\\\"] {\\n\\tbackground-color: white;\\n}\\n\\n[my_lom_theme=\\\"dark\\\"] {\\n\\tbackground-color: black;\\n}\\n\"\n) }"]}